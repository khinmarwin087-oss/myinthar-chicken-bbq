<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Order - Myin Thar Roast</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --gold: #D4AF37; --navy: #0F172A; --pearl: #F8FAFC; }
        body { font-family: 'Inter', sans-serif; background: var(--pearl); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .card { background: white; width: 100%; max-width: 400px; border-radius: 35px; padding: 35px 25px; box-shadow: 0 15px 40px rgba(0,0,0,0.06); text-align: center; }
        
        .stepper { position: relative; display: flex; flex-direction: column; gap: 35px; text-align: left; margin: 30px 0 30px 15px; }
        .step { display: flex; align-items: center; gap: 20px; opacity: 0.2; transition: 0.5s; }
        .step.active { opacity: 1; }
        .step.done { opacity: 1; color: #10B981; }
        .icon-box { width: 50px; height: 50px; background: #F1F5F9; border-radius: 18px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .step.active .icon-box { border: 2px solid var(--gold); color: var(--gold); background: white; }
        .step.done .icon-box { background: #10B981; color: white; }

        .line-progress { position: absolute; left: 24px; top: 0; width: 2px; height: 0%; background: var(--gold); z-index: -1; transition: 1s; }
        .line-bg { position: absolute; left: 24px; top: 0; width: 2px; height: 100%; background: #eee; z-index: -2; }

        .details { text-align: left; background: #f8fafc; padding: 20px; border-radius: 20px; margin-top: 20px; font-size: 13px; width: 100%; box-sizing: border-box; }
        .btn-home { margin-top: 30px; width: 100%; background: var(--navy); color: var(--gold); border: none; padding: 18px; border-radius: 20px; font-weight: 800; cursor: pointer; }
    </style>
</head>
<body>

<div class="card">
    <b style="color:var(--gold);">ORDER ID: #<span id="display-id">----</span></b>
    
    <div class="stepper">
        <div class="line-bg"></div>
        <div class="line-progress" id="line-p"></div>
        <div class="step" id="s1"><div class="icon-box"><i class="fas fa-receipt"></i></div><div><b>Order Received</b><br><small>လက်ခံရရှိပါပြီ</small></div></div>
        <div class="step" id="s2"><div class="icon-box"><i class="fas fa-fire-burner"></i></div><div><b>Preparing</b><br><small>ချက်ပြုတ်နေပါပြီ</small></div></div>
        <div class="step" id="s3"><div class="icon-box"><i class="fas fa-bag-shopping"></i></div><div><b>Ready</b><br><small>လာယူနိုင်ပါပြီ</small></div></div>
    </div>

    <div class="details">
        <p><b>ပစ္စည်းများ:</b> <br><span id="det-items" style="color:#64748B;">Loading...</span></p>
        <p><b>စုစုပေါင်းကျသင့်ငွေ:</b> <span id="det-total">0</span> K</p>
    </div>

    <button class="btn-home" onclick="location.href='index.html'"><i class="fas fa-arrow-left"></i> BACK TO MENU</button>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbywjHKV0aed5dV41xkLi_sZOOkXSzpkL6PAqJbMc1OR_JgQOmCyqIr_yE6C9eD2G4zy/exec";
    const urlParams = new URLSearchParams(window.location.search);
    const orderId = urlParams.get('id');
    document.getElementById('display-id').innerText = orderId || "None";

    async function check() {
        if(!orderId) return;
        try {
            const res = await fetch(`${SCRIPT_URL}?id=${orderId}`);
            const data = await res.json();
            
            const s1=document.getElementById('s1'), s2=document.getElementById('s2'), s3=document.getElementById('s3'), line=document.getElementById('line-p');
            [s1,s2,s3].forEach(s => s.classList.remove('active','done'));
            
            if(data.status==="Pending"){ s1.classList.add('active'); line.style.height="0%"; }
            else if(data.status==="Accepted" || data.status==="Processing"){ s1.classList.add('done'); s2.classList.add('active'); line.style.height="50%"; }
            else if(data.status==="Ready"){ s1.classList.add('done'); s2.classList.add('done'); s3.classList.add('active'); line.style.height="100%"; }

            document.getElementById('det-items').innerText = data.items || "-";
            document.getElementById('det-total').innerText = Number(data.total).toLocaleString();
        } catch(e) {}
    }
    setInterval(check, 5000); check();
</script>
</body>
</html>
